<html>
<head>
    <title>Execution</title>
    <meta name="generator" content="DocPad v6.59.6" />
    
</head>
<body>
    <h1>Execution</h1>
<h3>Author: Jonas Colmsjo</h3>
<h3>Date: Sun Jan 01 2012 01:00:00 GMT+0100 (CET)</h3>
<div><p>Yet another post</p>
<p>[[wiki]] &gt; [[Technical Architecture]] &gt; [[Execution Architecture]]</p>
<p>h1. Execution Architecture Design</p>
<p>h2. PHP &amp; MySQL Execution Architecture Design</p>
<p>h3. Background</p>
<p>Links:
<em> MySQL cluster: <a href="http://www.google.se/url?sa=t&amp;rct=j&amp;q=mysql%20proxies%20load%20balancinf%2Bpdf&amp;source=web&amp;cd=2&amp;ved=0CDYQFjAB&amp;url=http%3A%2F%2Fdownloads.mysql.com%2Fforge%2Fslides%2FMySQL-Proxy.pdf&amp;ei=JkXjTvOJIqTR4QSjoZWUBQ&amp;usg=AFQjCNEbFSNCWhdhdj70i3ZFbG60cD949A">http://www.google.se/url?sa=t&amp;rct=j&amp;q=mysql%20proxies%20load%20balancinf%2Bpdf&amp;source=web&amp;cd=2&amp;ved=0CDYQFjAB&amp;url=http%3A%2F%2Fdownloads.mysql.com%2Fforge%2Fslides%2FMySQL-Proxy.pdf&amp;ei=JkXjTvOJIqTR4QSjoZWUBQ&amp;usg=AFQjCNEbFSNCWhdhdj70i3ZFbG60cD949A</a>
</em> <a href="http://wiki.scalr.net/Tutorials/Setup_MySQL_proxy?highlight=mysql+proxy">http://wiki.scalr.net/Tutorials/Setup_MySQL_proxy?highlight=mysql+proxy</a></p>
<p>A load balancing cluster with failover functionality will be used. Initial thoughts on desgin:
<em> one laod balancer (likely ngix), 
</em> two apache server - need HA client in order to mange failover between the two MySQL proxies
<em> two MySQL server, one master and one slave
</em> Two load balancing MySQL proxies will be used to manage that writes are written to the master and reads distributed to all servers</p>
<p>Scalr&#39;s pre-configured images are used. </p>
<p>Ubuntu 10.04 will be used for both application servers and database servers. The main reason is that ubuntu has a newer PHP version than CentOS 5,5.</p>
<p>The MySQL database server will run on failover cluster using MySQL master-slave synchronization. </p>
<p>The laod balancer will initially run a micro image while the database and application server runs on small images.</p>
<p>Application and database server should have minimum 2 instances in the scaling options. Maximum should also be set to two instances (and scaling disabled).</p>
<p>The server will consist of:
<em> Load balancer: lb-nginx-centos-ebs ubuntu 10.04l, x32
</em> Applications servers: app-apache-ubuntu-ebs Ubuntu 10.04, x32
* Database servers: percona-ubuntu1004 Ubuntu 10.04, x32</p>
<p>Platform: Amazon EC2
Location: AWS /EU West 1 (Ireland)</p>
<p>h3. Application server</p>
<p>The OS for the application server is Ubuntu 10.04. PHP version is 5.3.X.</p>
<p>In addition to the standard modules should the following modules should be installed:
<em> php-pecl-apc - PHP opcache
</em> Postfix (for sending mail)
<em> Subversion client
</em> ec2-api-tools</p>
<p>Consider the folowing for system Admin:
<em> webmin (not installed yet)
</em> phpMyAdmin (not installed yet)</p>
<p>h4. SSL</p>
<p>All communication with vTiger and the portal should be encrypted with SSL. It should not be possible to connect using standard http. Port 80 should be closed in the firewall and apache should not listen on port 80.</p>
<p>A SSL certificate from RapidSSL is available here. This is a wildcard certificate that can be used for all subdomains of gizurcloud.com
<a href="http://s2.gizur.com:81/attachments/download/64/gizurcloud.com_RapidSSL_Wildcard_Order.pdf">http://s2.gizur.com:81/attachments/download/64/gizurcloud.com_RapidSSL_Wildcard_Order.pdf</a></p>
<p>Preparations (needed for the vTifger portal to work):</p>
<pre>
sudo apt-get install php5-curl
service apache2 restart
</pre>

<p>SSL is configured in scalr when setting up the virtual host.</p>
<p>h3. Database server</p>
<p>Standard MySQL 5 is used. The scalr MySQL role which has a master/slave setup is used.</p>
<p>h3. Management Server</p>
<p>The scalr ASP service will be used for the production environment. </p>
<p>Login here: <a href="https://my.scalr.net/#/dashboard">https://my.scalr.net/#/dashboard</a></p>
<p>h4. Testing of scalr </p>
<p>Scalr is open source and it is possible to install your own scalr server. This requires that you have your own nameservers for the managed domain though.
A separate scalr test environment is usefull when doing performance testing since scalr charges based on the number of servers being managed. </p>
<p>Howto install a scalr server on ubuntu is described here: [[Installation of management server]]. Scalr supports centos but I&#39;ve not been able to install all dependencies on Rackspace centos 5.6.</p>
</div>
    
</body>
</html>
